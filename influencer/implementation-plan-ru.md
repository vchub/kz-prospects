# Проект Гамма (CPA-платформа для инфлюенсеров) — План реализации

**Дата:** 1 февраля 2026 г.
**На основе:** Отчета Deep Search (31 января 2026 г.)
**Команда:** Программная инженерия и Маркетинговая стратегия

---

## 1. Краткий обзор
Этот документ описывает план технической и рыночной реализации «Проекта Гамма» — CPA (Cost-Per-Action) платформы, соединяющей микро-инфлюенсеров Казахстана с ритейлерами (Wildberries, Magnum, Technodom).

**Ключевое ценностное предложение:**
1.  **Для ритейлеров:** Маркетинг, основанный на результатах (оплата только за продажи, а не за посты).
2.  **Для инфлюенсеров:** Автоматизированная монетизация аудитории + **Автоматизированное налоговое соблюдение** (решение юридической головной боли).

---

## 2. Архитектура программного обеспечения

### 2.1 Архитектура высокого уровня
Изначально мы примем архитектуру **Модульного монолита** для скорости разработки, с переходом на **Микросервисы** по мере масштабирования нагрузки на трекинг. Система в значительной степени полагается на событийно-ориентированную (event-driven) обработку для атрибуции.

### 2.2 Основные компоненты

#### А. «Обертка ссылок» (Движок Deep Link) — *Ключевая технология*
*   **Функция:** Берет стандартный URL продукта (например, `wildberries.kz/catalog/123`) и оборачивает его в домен отслеживания (например, `gamma.kz/click?ref=user_id&target=url`).
*   **Требования:**
    *   Задержка перенаправления < 50 мс.
    *   Снятие отпечатков устройства (IP, User Agent) для вероятностной атрибуции в качестве запасного варианта.
    *   Возможности диплинкинга (открытие целевого приложения вместо браузера, если оно установлено).

#### Б. Слушатель атрибуции (Обработчик постбэков)
*   **Функция:** Эндпоинт, который получает «События конверсии» от ритейлеров.
*   **Протокол:** Server-to-Server (S2S) Postbacks.
    *   *Поток:* Пользователь кликает ссылку -> Gamma записывает ClickID -> Перенаправляет к ритейлеру с `?sub1=ClickID` -> Пользователь покупает -> Сервер ритейлера отправляет вебхук в Gamma с `ClickID` + `Сумма`.

#### В. Реестр «Налоги и Кошелек»
*   **Функция:** Управляет виртуальными балансами, разделяет средства на «В ожидании» (период возврата) и «Доступные», а также рассчитывает удержание налогов.
*   **Логика:**
    *   Валовая комиссия: 1000 тенге
    *   Комиссия платформы (20%): -200 тенге
    *   Удержание налога (10% - для примера): -100 тенге
    *   Чистая выплата инфлюенсеру: 700 тенге

### 2.3 Рекомендации по технологическому стеку
*   **Бэкенд:** **Node.js (TypeScript)** или **Go**. Node.js предпочтителен для быстрой итерации; Go — для микросервиса редиректа/трекинга, если трафик вырастет до миллионов кликов.
*   **База данных:**
    *   **PostgreSQL:** Для пользователей, кошельков и реестра (ACID-совместимость критична для денег).
    *   **ClickHouse:** Для аналитики большого объема кликов/событий (отчетность).
    *   **Redis:** Для кэширования правил редиректа и токенов активных сессий.
*   **Фронтенд:**
    *   **Приложение для инфлюенсеров:** **Flutter** (Кроссплатформенное iOS/Android). Микро-инфлюенсеры работают в основном с мобильных устройств.
    *   **Дашборд бренда:** **React.js**.
*   **Инфраструктура:** Контейнеризация (Docker/Kubernetes). Хостинг в локальном облаке (например, PS Cloud или VK Cloud) или AWS, если позволяет задержка/резидентность данных.

---

## 3. Стратегия API третьих сторон

### 3.1 Wildberries (Интеграция «Wibes»)
*   **Статус:** Критическая зависимость.
*   **Точка интеграции:** API Wildberries для партнеров (Wibes).
*   **Необходимые данные:**
    *   Каталог товаров (чтобы позволить инфлюенсерам искать/выбирать товары внутри нашего приложения).
    *   Статус заказа (В ожидании -> Доставлен -> Возвращен).
*   **Риск:** Стабильность API. Мы должны создать защитного воркера «Опроса статусов» для проверки завершения заказов, если вебхуки не сработают.

### 3.2 Прямые интеграции с ритейлерами (Magnum / Technodom)
*   **Проблема:** У этих игроков, вероятно, отсутствует стандартизированный публичный партнерский API.
*   **Решение:** Мы предоставим стандартный **«Пиксель Gamma»** и **Спецификацию постбэка**.
    *   *Реализация:* Их техническая команда добавляет наш Javascript SDK на страницу успешного оформления заказа ИЛИ настраивает свой бэкенд на отправку HTTP POST нам при успешной оплате.
*   **Рычаг Alpha/RMN:** Использовать существующие отношения в рамках Retail Media Network, чтобы сделать эту техническую интеграцию приоритетной.

### 3.3 Финтех и Налоги (Слой «Безопасность»)
*   **Партнеры:** **Wooppay**, **Qiwi** или **Kassa24**.
*   **Интеграция:** «Массовые выплаты».
*   **Налоговая логика:**
    *   Проверка ИИН пользователя (Национальный ID).
    *   Проверка статуса «Самозанятый» (ЕСП - *прим: проверить актуальность*) или ИП через базу данных e-gov (если доступна) или требование загрузки регистрации.
    *   *Автоматическое удержание:* Мы действуем как налоговый агент. Мы вычитаем налог *до* отправки чистой суммы на карту инфлюенсера.
    *   **Вызов API:** `Payout(Amount, Tax_Component, Destination_Card)`.

---

## 4. Маркетинговая стратегия: Плюсы, Минусы и Разворот (Pivot)

### 4.1 Питч (Подача)
*   **Инфлюенсерам:** «Хватит бегать за брендами ради оплаты. Продвигайте то, что любите, получайте оплату автоматически и **больше никогда не беспокойтесь о Налоговой**».
*   **Брендам:** «Получите доступ к "Длинному хвосту" из 5000 инфлюенсеров без управления 5000 контрактов. Платите только за Продажи».

### 4.2 Плюсы (Почему это выиграет)
1.  **Ров «Безопасности»:** Беря на себя налоговые сложности (которые пугают 19-летнего инфлюенсера), мы привязываем их к нашей платформе.
2.  **Открытие Wildberries:** WB быстро растет. Инфлюенсеры и так покупают там. Монетизация их «распаковок» — это естественный контент.
3.  **Доминирование в данных:** Мы будем владеть данными о конверсиях для рынка вне Kaspi, что сделает нас ценными для рекламодателей.

### 4.3 Минусы (Вызовы)
1.  **«Стена Kaspi» (Маркетинговое влияние):** Пользователи *хотят* покупать на Kaspi. Если мы отправим их в Technodom, конверсия будет ниже. Мы должны обучать инфлюенсеров говорить конкретно: «Ссылка в био на Technodom».
2.  **Культурное трение:** Инфлюенсеры привыкли к «Фиксированной плате» (получить 20 тыс. тенге просто за пост). Переход на «Заработай 5% от продаж» кажется им рискованным.
    *   *Смягчение:* Гибридная модель? (Небольшой фикс + Комиссия) для топ-перформеров.
3.  **Утечка атрибуции:** Пользователи кликают ссылку на мобильном, приложение не открывает диплинк корректно, или они меняют устройство. Мы потеряем ~20-30% отслеживания продаж. Это вызывает проблемы с доверием («Я продал 10, вы отследили 5»).

### 4.4 Фазы запуска
*   **Фаза 1 (Обертка):** Ручной MVP. Отобрать 50 инфлюенсеров. Выдать им вручную сгенерированные ссылки WB. Отслеживать через ручной экспорт отчетов WB. Тестировать выплаты.
*   **Фаза 2 (Приложение):** Запуск приложения на Flutter. Автоматическая генерация ссылок. Интеграция с Wooppay. Открытие для топ-500.
*   **Фаза 3 (Экосистема):** Интеграция API Magnum/Technodom. Открытие для всех.

---

**Вердикт:** Техническая сборка стандартна. *Бизнес*-сложность заключается в интеграции Финтех/Налогов и техническом сопровождении продаж (Sales Engineering), необходимом для того, чтобы заставить ритейлеров внедрить наши постбэки.